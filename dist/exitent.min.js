"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Exitent=t()}(void 0,function(){var e={threshold:100,maxDisplays:1,eventThrottle:800,checkReferrer:!0,preExitent:null,onExitent:null,postExitent:null},t=function(){function t(n){_classCallCheck(this,t),this.eventListeners=new Map,this.displays=0,this.options=e,1===arguments.length&&"object"===("undefined"==typeof n?"undefined":_typeof(n))&&(this.options=this.mergeOptions(e,n)),this.init()}return _createClass(t,[{key:"addEvent",value:function(e,t,n){var o="document"===e?document:document.getElementById(e);o.addEvent?o.attachEvent("on"+t,n):o.addEventListener(t,n,!1),this.eventListeners.set(e+":"+t,{element:o,eventName:t,callback:n})}},{key:"executeCallbacks",value:function(){var e=this.options,t=e.preExitent,n=e.onExitent,o=e.postExitent;null!==t&&"function"==typeof t&&t(),null!==n&&"function"==typeof n&&n(),null!==o&&"function"==typeof o&&o()}},{key:"handleMouseEvent",value:function(){this.displays++,this.executeCallbacks(),this.shouldRemoveEvents()}},{key:"init",value:function(){var e=this,t=function(t){e.mouseDidMove(t)};this.addEvent("document","mousemove",t)}},{key:"mergeOptions",value:function(e,t){return Object.keys(e).forEach(function(n){e[n]=t[n]}),e}},{key:"mouseDidMove",value:function(e){if(this.shouldDisplay(e.clientY)){if(this.options.checkReferrer){if(""===document.referrer)return;var t=document.createElement("a");if(t.href=document.referrer,t.host!==document.location.host)return}this.handleMouseEvent()}}},{key:"removeEvent",value:function(e){var t=this.eventListeners.get(e),n=t.element,o=t.eventName,i=t.callback;n.removeEventListener(o,i),this.eventListeners.delete(e)}},{key:"shouldDisplay",value:function(e){var t=this.options,n=t.threshold,o=t.maxDisplays,i=this.displays;return e<=n&&i<o}},{key:"shouldRemoveEvents",value:function(){var e=this;this.displays>=this.options.maxDisplays&&this.eventListeners.forEach(function(t,n,o){e.removeEvent(n)})}}]),t}();return t});